% vim:ts=1:et:nospell:spelllang=en_gb:ft=tex

\usepackage{xspace}
\usepackage{xparse}

\usepackage{listings}
\usepackage{color}

\newcommand\code{\lstinline[basicstyle=\ttfamily\selectfont, breaklines=true, breakatwhitespace=true]}
\NewDocumentCommand\ppt{s}{\IfBooleanTF#1{{Microsoft PowerPoint}\xspace}{{PowerPoint}\xspace}}
\newcommand\mxp{{MindXpres}\xspace}
\newcommand\latex{\LaTeX\xspace}
\newcommand\lstref[1]{Listing \ref{lst:#1}}
\newcommand\figref[1]{Figure \ref{fig:#1}}
\newcommand\fig[2]{
 \begin{figure}[h!]
  \centering
  \includegraphics[width=0.85\textwidth]{img/#1.png}
  \caption{#2}
  \label{fig:#1}
 \end{figure}
}

%\lstloadlanguages{C}

\definecolor{maroon}{rgb}{0.6,0,0}
\definecolor{darkgreen}{rgb}{0,0.65,0.1}
\definecolor{darkblue}{rgb}{0,0,0.7}
\definecolor{grey}{rgb}{0.90,0.90,0.90}
\definecolor{pblue}{rgb}{0.13,0.13,1}
\definecolor{pgreen}{rgb}{0,0.5,0}
\definecolor{pred}{rgb}{0.9,0,0}
\definecolor{pgrey}{rgb}{0.46,0.45,0.48}
\lstdefinelanguage{XML} {
  morestring=[s]{"}{"},
  morecomment=[s]{<?}{?>},
  morecomment=[s]{<!--}{-->},
  commentstyle=\color{blue},
  moredelim=[s][\color{maroon}]{\ }{=},
  moredelim=[s][\color{black}]{>}{<},
  moredelim=[s][\color{black}]{\ />}{<},
  stringstyle=\color{darkgreen},
  identifierstyle=\color{darkblue}
}

\lstnewenvironment{lstjava}[2]
{
  \csname lst@SetFirstLabel\endcsname
  \lstset{language=Java,
  showspaces=false,
  showtabs=false,
  breaklines=true,
  showstringspaces=false,
  breakatwhitespace=true,
  commentstyle=\color{pgreen},
  keywordstyle=\color{pblue},
  stringstyle=\color{pred},
  moredelim=[il][\textcolor{pgrey}]{$$},
  moredelim=[is][\textcolor{pgrey}]{\%\%}{\%\%}
  }
}
{
  \csname lst@SaveFirstLabel\endcsname
  \centering
  \renewcommand{\figurename}{Listing}
  \renewcommand{\figureshortname}{Lst.}
  \caption{#2}
  \label{lst:#1}
}

\lstnewenvironment{lstxml}[2]
{
  \csname lst@SetFirstLabel\endcsname
  \lstset{language=XML}
}
{
  \csname lst@SaveFirstLabel\endcsname
  \centering
  \renewcommand{\figurename}{Listing}
  \renewcommand{\figureshortname}{Lst.}
  \caption{#2}
  \label{lst:#1}
}

\lstnewenvironment{lstxml*}
{
 \csname lst@SetFirstLabel\endcsname
 \lstset{language=XML,
         xrightmargin=0pt
         }
}
{
 \csname lst@SaveFirstLabel\endcsname
}

\lstnewenvironment{lstxmlnoref}[0]
{
  \csname lst@SetFirstLabel\endcsname
  \lstset{language=XML}
}
{
  \csname lst@SaveFirstLabel\endcsname
}

\newcommand\fignl[1]{
 \centering
 \includegraphics[width=\textwidth]{img/#1.png}
}

\newcommand\cl[2]{
 \centering
 \caption{#2}
 \label{lst:#1}
}

\lstset{
         basicstyle=\ttfamily\fontsize{7pt}{8pt}\selectfont,
         numbers=left,                   % where to put the line-numbers
         numberstyle=\fontsize{7pt}{8pt}\selectfont,      % the size of the fonts that are used for the line-numbers
         stepnumber=1,                   % the step between two line-numbers. If it is 1 each line will be numbered
         numbersep=1em,                  % how far the line-numbers are from the code
         backgroundcolor=\color{grey},   % choose the background color. You must add \usepackage{color}
         showspaces=false,               % show spaces adding particular underscores
         showstringspaces=false,         % underline spaces within strings
         showtabs=false,                 % show tabs within strings adding particular underscores
         frame=single,           % adds a frame around the code
         frameround=tttt,
         flexiblecolumns=false,
         basewidth={0.5em,0.45em},
         linewidth=\textwidth,
         xleftmargin=2em,
         xrightmargin=1em
         }
